<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Smart Complaint Box</title>

  <!-- CSS -->
  <link rel="stylesheet" href="./css/style.css">

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- ğŸ” Firebase Auth (PROTECT PAGE + GET USER) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, onAuthStateChanged }
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDzcZLM7TuZ48mOi8SSEH_k3DOgPPCS78c",
      authDomain: "complaint-box-88c9b.firebaseapp.com",
      projectId: "complaint-box-88c9b",
      appId: "1:545419902164:web:74f9ef082557ffe31d0f41"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Make user available globally
    window.currentUser = null;

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = "login.html";
      } else {
        window.currentUser = user;
      }
    });
  </script>
</head>

<body>

<div class="container">
  <h1>ğŸ“¢ Smart Complaint Box</h1>
  <p class="subtitle">
    Report issues easily. Weâ€™ll prioritize them intelligently.
  </p>

  <form id="complaintForm">

    <label>ğŸ“ Complaint Description</label>
    <textarea
      id="text"
      placeholder="Describe the issue in detail..."
      required
    ></textarea>

    <label>ğŸ“ Select Location on Map</label>
    <div id="map"></div>

    <label>ğŸ  Location Name</label>
    <input type="text" id="location" placeholder="Enter location name (e.g., Park Street, Chennai)" required>

    <label>ğŸ“· Upload Photo (optional)</label>
    <input type="file" id="photo" accept="image/*">

    <button id="submitBtn" type="submit">
      ğŸš€ Submit Complaint
    </button>

  </form>

  <div id="result" style="display:none;">
    <h3>âœ… Complaint Registered</h3>
    <p><strong>Category:</strong> <span id="category"></span></p>
    <p><strong>Priority:</strong> <span id="priority"></span></p>
  </div>
</div>

<!-- Complaint JS -->
<script src="./js/complaint.js"></script>
</body>
</html>
