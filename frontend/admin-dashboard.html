<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard | Complaint Box</title>

  <link rel="stylesheet" href="./css/dashboard.css">

  <!-- Leaflet -->
  <link rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>

<body>

<div class="dashboard">

  <!-- Sidebar -->
  <div class="sidebar">
    <h2>ğŸ›  Admin</h2>

    <a href="dashboard.html">
      <i class="fas fa-user"></i> ğŸ—ï¸User Dashboard
    </a>

    <a href="#" onclick="logout()">
      <i class="fas fa-sign-out-alt"></i> ğŸšªLogout
    </a>
  </div>

  <!-- Main -->
  <div class="main">

    <!-- Complaint List -->
    <div class="list">
      <h3>All Complaints</h3>

      <!-- Filters -->
      <div class="filters">
        
<select id="filterType">
  <option value="" disabled selected>Select filter</option>
  <option value="all" selected>All Complaints</option>
  <option value="priority">Priority</option>
  <option value="category">Category</option>
  <option value="email">Email</option>
</select>


        <select id="filterValue" style="display:none;"></select>
      </div>

      <div id="complaintList"></div>
    </div>

    <!-- Map -->
    <div id="map"></div>

  </div>
</div>

<script src="./js/admin-dashboard.js"></script>

<!-- Firebase Auth (protect admin page) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut }
  from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDzcZLM7TuZ48mOi8SSEH_k3DOgPPCS78c",
    authDomain: "complaint-box-88c9b.firebaseapp.com",
    projectId: "complaint-box-88c9b",
    appId: "1:545419902164:web:74f9ef082557ffe31d0f41"
  };

  const ADMIN_EMAIL = "hxrini122007@gmail.com";

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  onAuthStateChanged(auth, (user) => {
    if (!user || user.email !== ADMIN_EMAIL) {
      alert("Access denied");
      window.location.href = "login.html";
    }
  });

  window.logout = function () {
    signOut(auth).then(() => {
      window.location.href = "login.html";
    });
  };
</script>

</body>
</html>
